<!DOCTYPE html>
<html>
<head>
    <title>Обработка авторизации</title>
    <script>
        // Получаем параметры из URL
        function getAuthData() {
            const hash = window.location.hash.substring(1);
            if (!hash) return null;

            const params = new URLSearchParams(hash);
            return {
                access_token: params.get('access_token'),
                account_id: params.get('account_id'),
                nickname: params.get('nickname'),
                expires_at: params.get('expires_at')
            };
        }

        // Отправляем данные в основное окно
        function sendAuthData() {
            const authData = getAuthData();
            if (authData && authData.access_token) {
                window.opener.postMessage({
                    type: 'lesta_auth_success',
                    ...authData
                }, '*');
            } else {
                window.opener.postMessage({
                    type: 'lesta_auth_failed'
                }, '*');
            }
            window.close();
        }

        // Вызываем при загрузке
        window.onload = sendAuthData;
    </script>
</head>
<body>
    <div style="text-align: center; margin-top: 50px;">
        <h3>Завершение авторизации...</h3>
    </div>
</body>
</html>
